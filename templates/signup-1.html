<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SSO :: Sign Up - First Screen</title>

<link rel="stylesheet" href="static/css/sso.css" type="text/css">
<link rel="stylesheet" href="static/css/responsive.css" type="text/css">


</head>
<body>

<div class="wrapper">

<!-- Header Dv -->
<div class="hide" style="padding:15px;"><a href="#login" name="login" rel="popupModal">Login</a></div>
<!-- Header Dv cl-->


<!-- SignIn Dv -->
<div class="signinDv" id="login">
            <!--<div class="close"><a href="#" class="close">X</a></div>-->
            <div class="signin-container">
                      <!-- Sign Up Dv -->
                      <div id="signFrm">
                            <h2>Sign Up</h2>
                            <div class="frmDv">
                                <form id="signUp" action="">
                                <input type="text" name="name" placeholder="Name" class="user" autofocus>
                                <input type="text" name="email" placeholder="Email Address" class="mail">
                                <input type="text" name="city" placeholder="City" class="city">
                                <input type="password" name="pwd" placeholder="Password" class="pwd">
                                <input type="password" name="cpwd" placeholder="Confirm Password" class="pwd">
                                <input type="submit" name="sbmt" value="Sign up" class="btn">
                                </form>
                                
                            </div>
                      </div>
                      <!-- Sign Up Dv cl -->              
            </div>                                                 
<div class="clr"></div>
</div>
<!-- SignIn Dv cl-->



</div><!-- Wrapper Dv cl -->

<script src="static/scripts/jquery.js" type="text/javascript"></script>
<script type="text/javascript" src="static/scripts/jquery.popup.min.js"></script>
<script type="text/javascript">
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
        } else { 
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
    }
    var lat=0, lng =0, ip="0.0.0.0";
    function showPosition(position) {
        // x.innerHTML = "Latitude: " + position.coords;  
        lat=position.coords.latitude;
        lng=position.coords.longitude;
    }
    function myIP() {
        if (window.XMLHttpRequest) xmlhttp = new XMLHttpRequest();
        else xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");

        xmlhttp.open("GET","http://api.hostip.info/get_html.php",false);
        xmlhttp.send();

        hostipInfo = xmlhttp.responseText.split("\n");

        for (i=0; hostipInfo.length >= i; i++) {
            ipAddress = hostipInfo[i].split(":");
            if ( ipAddress[0] == "IP" ) return ipAddress[1];
        }

        return "0.0.0.0";
    }
    ip=myIP();
    getLocation();
    $('form[id="signUp"]').submit(function(event)
    {
        event.preventDefault();
        var ip_Add=myIP()
        var payload={name:$('input[name="name"]').val(),city:$('input[name="city"]').val(),email:$('input[name="email"]').val(),psword:$('input[name="pwd"]').val(),ip:ip,geo:"("+lat+","+lng+")"}
        $.ajax(
            {
                url: "/signupAPI",
                type: "POST",
                crossDomain: true,
                data: payload,
                datatype:'html',
                success: function (data) {
                    if(data=="True")
                        window.location.assign('/signup_proceed')
                    else
                        console.log(data)
                }
        });

    })


	$(function() {
		$('a[rel*=popupModal]').popupModal({closeButton: ".close" });  /*top: 20 ,*/
	});
    
  $(document).ready(function(){
    $('a[rel*=popupModal]').click()
  })
</script>

</body>
</html>
