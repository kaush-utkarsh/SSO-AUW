<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SSO :: Sign In - Second Screen</title>

<link rel="stylesheet" href="static/css/sso.css" type="text/css">
<link rel="stylesheet" href="static/css/responsive.css" type="text/css">


</head>
<body>

<div class="wrapper">

<!-- Header Dv -->
<div class="hide" style="padding:15px;"><a href="#login" name="login" rel="popupModal">Login</a></div>
<!-- Header Dv cl-->


<!-- SignIn Dv -->
<div class="signinDv" id="login">
            <!--<div class="close"><a href="#" class="close">X</a></div>-->
            <div class="signin-container">
							<!-- Sign In - Second Screen Dv -->
                            <div id="signFrm">
                                  <h2>Sign In</h2>
                                  <div class="frmDv">
                                  	  <form id="SignIn" action="">
                                      <input type="text" name="name" placeholder="User Name" class="user" autofocus>
                                      <input type="password" name="pwd" placeholder="Password" class="pwd">
                                      <input type="submit" name="sbmt" value="Sign In" class="btn">
                                      </form>
                                      <div class="btmLnksDv">
                                          <span class="fl"><a href="#">Forgot Password?</a></span>
                                          <span class="fr"><a href="/signup" class="undln">New Here? Sign Up</a></span>
                                      </div>
                                  </div>
                            </div>
                            <!-- Sign In - Second Screen Dv cl -->              
            </div>                                                 
<div class="clr"></div>
</div>
<!-- SignIn Dv cl-->



</div><!-- Wrapper Dv cl -->

<script src="static/scripts/jquery.js" type="text/javascript"></script>
<script type="text/javascript" src="static/scripts/jquery.popup.min.js"></script>
<script type="text/javascript">
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
        } else { 
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
    }
    var lat=0, lng =0, ip="0.0.0.0";
    function showPosition(position) {
        // x.innerHTML = "Latitude: " + position.coords;  
        lat=position.coords.latitude;
        lng=position.coords.longitude;
    }
    function myIP() {
        if (window.XMLHttpRequest) xmlhttp = new XMLHttpRequest();
        else xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");

        xmlhttp.open("GET","http://api.hostip.info/get_html.php",false);
        xmlhttp.send();

        hostipInfo = xmlhttp.responseText.split("\n");

        for (i=0; hostipInfo.length >= i; i++) {
            ipAddress = hostipInfo[i].split(":");
            if ( ipAddress[0] == "IP" ) return ipAddress[1];
        }

        return "0.0.0.0";
    }
    ip=myIP();
    getLocation();

    $('form[id="SignIn"]').submit(function(event)
    {

        event.preventDefault();
        var ip_Add=myIP()
        var payload={name:$('input[name="name"]').val(),psword:$('input[name="pwd"]').val(),ip:ip,geo:"("+lat+","+lng+")"}
        $.ajax(
            {
                url: "/signinAPI",
                type: "POST",
                crossDomain: true,
                data: payload,
                datatype:'html',
                success: function (data) {
                  if(data=="True")
                    window.location.assign('/signup_proceed')
                  else
                    console.log(data)
                }
        });

    })

	$(function() {
		$('a[rel*=popupModal]').popupModal({closeButton: ".close" });  /*top: 20 ,*/
	});
  
  $(document).ready(function(){
    $('a[rel*=popupModal]').click()
  })
</script>

</body>
</html>
